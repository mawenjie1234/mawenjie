##【目标】

* 新产出的页面性能无问题
* 页面布局结构合理，脚本和节点使用合理，95%产出的页面布局合理
* 新产出的页面处理UI代码质量会比较好

---



##【场景】

* 角色：DEV
* 当需要新创建一个新页面，触发工作流，直到新页面关于UI功能编码结束

---



##【流程】

1. 页面需求分析（UI需求，交互需求，数据来源需求，打点需求）
2. 如果复杂讨论
3. 创建（创建页面Prefab，页面对应Component）
4. 布局（Prefab 构建过程）参考 《布局好坏方法论》
5. 布局Review（Prefab 布局合理检查，挂在脚本合理检查）
6. 逻辑代码 （页面交互，动画，页面刷新）
7. 测试 TODO



 1 页面需求分析

* 你要写出分析后要做的事情
* 

---



##【决策点】

### 页面需求分析 - 适配

* 思考维度：
  * 我们的产品有pad适配，需要考虑不做Pad适配的UI在Pad上显示是否正常
  * pad适配会在原有的UI基础工作量上增加比较大对，布局方式需要调整，UI变动可能较大，需要多设备测试
  * 普通手机适配也需要考察特别长和特别宽的手机
  * pad一般展示更多内容，对性能也会提出更高要求
  * 刘海屏适配，头顶超出去的部分经常需要特意设计，不然非常难看
* 角色：Dev， 设计师，测试
* 方法论：根据《适配方法论》进行页面适配评估和实现
* 输入：页面需求，设计师页面设计
* 输出：设计文档 - 页面基本适配设计文档

#### 需不需要找人讨论

### 换皮配置 TODO

### 页面需求分析 - 性能分析与检测

* 思考维度
  * 页面性能的一些关键指标可以通过事先计算出来的，所以在做得时候可以逼近这个理论值
  * 性能分析和优化提前做
* 方法论：参考《UI性能评估和以及优化》方法论，做好事先评估，做完后测试
  * draw call ，over draw，资源加载速度
* 输入：设计师给的设计图以及完成后的app，
* 输出：设计文档 - 理论性能数据和实际性能数据

### 页面需求分析 - 图片放包内

* 决策点：图片资源放本地会增加包体积，需要考量新增资源对收益影响，以及是否可以删除不用的本地资源
* 思考维度：尽量能做出收益影响的评估，如果可以话，也问问PM是不是可以删一些旧的图
* 角色：PM和DEV



### 布局划分和布局使用方式决策 TODO 删除，写到方法论

* 思考维度：好的布局可以几乎不写布局代码，大量出现的位置调整代码，需要想一想有没有更聪明的办法
* 选择路径
  * 1 重复有限节点使用“style” 的方式，定义各自不同的长相，变成配置。
  * 2 一个节点的隐藏消失会影响别的节点布局方式，使用Layout 而不是自己写布局
  * 3 重复节点但个数比较多，超过十几个，使用RecycleView
* 输出：设计文档 - 布局模块划分

### UI组件间联动

* 思考维度：跨模块View找View经常会导致一个模块持有了另外一个模块的View实例，拿到了对方的对象，很容易直接调用，导致耦合过于紧密
* 路径
  * 一对一的View使用 Pipe 进行事件传递
  * 自定义管理类事件传递
  * 找一下有没有对应的设计模式可以利用
* 案例
  * 通过参数传递组件，而不是内部通过Find，GetInParent，GetInChildren等方法
  * 一个按钮A点击 - > 直接调用文字B更改文字。 合理做法是， A点击修改数据，数据发生变化通知B更改文字

### 资源引用

* 思考维度：代码/拖拽Prefab 会导致加载没必要的资源
* 决策点：资源加载方式选择
* 路径：
  * 使用代码加载资源，会写一些代码，稍微麻烦
  * 使用Prefab拖拽，不小心拖拽了不需要的资源
  * 使用《D09_资源管理(Unity运行时)》
* 案例：
  * loading页面有不同的UI样式，不同的UI样式有不同的Prefab，都挂在到loading页下面导致多种UI样式的图片资源都加载了，应该使用代码动态加载不同的Prefab TODO 写个项目中的例子
  * 简单资源加载直接拖拽比较省事
  * 一个用户生命周期只出现一次的弹窗上有好几张大图，这几张图放入了一个经常被加载的图集中，严重影响了正常用户加载时长和内存消耗
* 方法论：《资源引用工作流》

### 组件选择

* 思考维度：组件选择合适，会减少代码量和出故障风险
*  合适组件的标准是什么
  * 目前已经有的组件必须使用，不方便的地方提需求而不是自己创建。比如多语言，网图等
  * 已有组件没有的功能可以通过和别的组件组合来完成
  * 使用方便，写代码少
* 怎么选择出好组件
  * 从项目中已有的选择
  * Unity的大部分都已经可以提供了
  * 从网上找
  * 自己做，自己做成本高，风险大，《参见如何写一个组件》，
  *  是不是可以调整需求，从现有的组件中选择
* 案例：
  * setting下有很多选择项，需要依次排列。可以使用Content Size Fitter + Vertical Layout Group
  * 多语言使用LocalizationText，文字加阴影不属于LocalizationText，新写一个脚本，使用组合的方式扩展。
  * 网图使用CacheImage，不满足需求情况下提出新需求而不是使用RawImage，这样会导致不在图片内存管理框架中

### 布局Review

* 思考维度：
  * 重视布局Review，布局好，代码更精炼
* 关键点
  * 布局树冗余节点检查
  * 删除页面冗余节点，精简Component，删除Component上多余的属性
  * 检查性能是否和理论值接近或者一致
  * 多语言检查
  * 适配
* 案例
  * 不需要接收点击事件的图/文字，去除Raycast Target

----



##【做事准则】

* 页面经常更换不是我们不写 好UI的理由

##【资产管理】

| 产出                                                         | 位置                                                         | 工具 | 权限 |
| ------------------------------------------------------------ | ------------------------------------------------------------ | ---- | ---- |
| 所有的产出放入设计文档                                       | 需求开发设计文档-页面设计                                    | wiki | dev  |
| 图片/Prefab/.cs 等文件参考[D06_工程文件管理](https://wiki.atcloudbox.com/pages/viewpage.action?pageId=29167686&src=contextnavpagetreemode) | [D06_工程文件管理](https://wiki.atcloudbox.com/pages/viewpage.action?pageId=29167686&src=contextnavpagetreemode) |      |      |



## 【参考资料】

* 性能测试方法论
* 性能分析方法论
* 网图使用方法论
* 《多语言使用规范》
* 《图片资源存放工作流》
* 《适配方法论》
* [D06_工程文件管理](https://wiki.atcloudbox.com/pages/viewpage.action?pageId=29167686&src=contextnavpagetreemode)







流程里面加一个 ： 复杂布局找人讨论

决策加：如何决策复杂布局

参照自己怎么做的，会不会漏东西